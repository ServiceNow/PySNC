<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Authentication &#8212; PySNC 1.1.10 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=039e1c02" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=5d9df9de"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="The API" href="../api.html" />
    <link rel="prev" title="Advanced" href="advanced.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="authentication">
<span id="id1"></span><h1>Authentication<a class="headerlink" href="#authentication" title="Permalink to this heading">¶</a></h1>
<section id="basic-authentication">
<h2>Basic Authentication<a class="headerlink" href="#basic-authentication" title="Permalink to this heading">¶</a></h2>
<p>Standard BasicAuth, every request contains your username and password base64 encoded in the request header. The most
insecure, but simplest, way to authenticate. Remember to scope the user’s ACLs to the minimum if using with automations.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">pysnc</span><span class="o">.</span><span class="n">ServiceNowClient</span><span class="p">(</span><span class="s1">&#39;dev00000&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span><span class="s1">&#39;password&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>This is not recommended for any production or machine to machine activity</p>
</section>
<section id="oauth2-password-grant-flow">
<h2>OAuth2 - Password Grant Flow<a class="headerlink" href="#oauth2-password-grant-flow" title="Permalink to this heading">¶</a></h2>
<p>OAuth2 password flow is currently supported and recommended</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnc</span> <span class="kn">import</span> <span class="n">ServiceNowClient</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnc.auth</span> <span class="kn">import</span> <span class="n">ServiceNowPasswordGrantFlow</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">client_id</span> <span class="o">=</span> <span class="s1">&#39;ac0dd3408c1031006907010c2cc6ef6d&#39;</span> <span class="c1"># oauth_entity.client_id</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">secret</span> <span class="o">=</span> <span class="s1">&#39;...&#39;</span> <span class="c1"># oauth_entity.client_secret</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">auth</span> <span class="o">=</span> <span class="n">ServiceNowPasswordGrantFlow</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">client_id</span><span class="p">,</span> <span class="n">secret</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">ServiceNowClient</span><span class="p">(</span><span class="n">server_url</span><span class="p">,</span> <span class="n">auth</span><span class="p">)</span>
</pre></div>
</div>
<p>This will use a users credentials to retrieve and store an OAuth2 auth and refresh token, sending your auth token with
every request and dropping your user and password from memory. This will automatically update your access tokens.</p>
<p>To configure this flow, create a new OAuth Application by selecting a new OAuth API endpoint:</p>
<img alt="../_images/oauth2-01.png" src="../_images/oauth2-01.png" />
<p>Name it, save/insert it, and note your new client_id and client_secret. This flow is sometimes called a Legacy flow, as it
is not the ideal method OAuth usage. In this flow it is tolerable to share/embed your client_secret.</p>
<img alt="../_images/oauth2-02.png" src="../_images/oauth2-02.png" />
</section>
<section id="oauth2-auth-code-grant-flow">
<h2>OAuth2 - Auth Code Grant Flow<a class="headerlink" href="#oauth2-auth-code-grant-flow" title="Permalink to this heading">¶</a></h2>
<p>No instructions, currently. Typically what you would want to use if you’re a client doing things on behalf of users.</p>
</section>
<section id="oauth2-client-credential-grant-flow">
<h2>OAuth2 - Client Credential Grant Flow<a class="headerlink" href="#oauth2-client-credential-grant-flow" title="Permalink to this heading">¶</a></h2>
<p>ServiceNow does not support this OAuth flow</p>
</section>
<section id="oauth2-jwt-bearer-grant-flow">
<h2>OAuth2 - JWT Bearer Grant Flow<a class="headerlink" href="#oauth2-jwt-bearer-grant-flow" title="Permalink to this heading">¶</a></h2>
<p>Create a new <a class="reference external" href="https://docs.servicenow.com/en-US/bundle/tokyo-platform-security/page/administer/security/task/create-jwt-endpoint.html">JWT Provider</a>
and use it with whomever generates your JWT tokens. Once you have your JWT you may use it to request a Bearer token for
standard auth:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">auth</span> <span class="o">=</span> <span class="n">ServiceNowJWTAuth</span><span class="p">(</span><span class="n">client_id</span><span class="p">,</span> <span class="n">client_secret</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">ServiceNowClient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">server</span><span class="p">,</span> <span class="n">auth</span><span class="p">)</span>
</pre></div>
</div>
<p>Wherein client_id and client_secret are the <cite>oauth_jwt</cite> record entry values and <cite>token</cite> is the JWT generated by your provider.</p>
<p>The token contains who are are logging in as - as such the PySNC library does not attempt to act as a provider. We do however
have an example of how that is done in the tests.</p>
</section>
<section id="mtls-mutual-tls-authentication-certificate-based-authentication">
<h2>mTLS - Mutual TLS Authentication (Certificate-Based Authentication)<a class="headerlink" href="#mtls-mutual-tls-authentication-certificate-based-authentication" title="Permalink to this heading">¶</a></h2>
<p>The most ideal form of authentication for machine to machine communication. Follow <a class="reference external" href="https://support.servicenow.com/kb?id=kb_article_view&amp;sysparm_article=KB0993615">KB0993615</a> then:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">ServiceNowClient</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">cert</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;/path/to/client.cert&#39;</span><span class="p">,</span> <span class="s1">&#39;/path/to/client.key&#39;</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="requests-authentication">
<h2>Requests Authentication<a class="headerlink" href="#requests-authentication" title="Permalink to this heading">¶</a></h2>
<p>Ultimately any authentication method supported by python requests (<a class="reference external" href="https://2.python-requests.org/en/master/user/authentication/">https://2.python-requests.org/en/master/user/authentication/</a>) can be passed directly to ServiceNowClient.</p>
<p>Should be flexible enough for any use-case.</p>
</section>
<section id="storing-passwords">
<h2>Storing Passwords<a class="headerlink" href="#storing-passwords" title="Permalink to this heading">¶</a></h2>
<p>The keystore module is highly recommended. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">keyring</span>


<span class="k">def</span> <span class="nf">check_keyring</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">user</span><span class="p">):</span>
    <span class="n">passw</span> <span class="o">=</span> <span class="n">keyring</span><span class="o">.</span><span class="n">get_password</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">passw</span>

<span class="k">def</span> <span class="nf">set_keyring</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">passw</span><span class="p">):</span>
    <span class="n">keyring</span><span class="o">.</span><span class="n">set_password</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">passw</span><span class="p">)</span>

<span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">password</span><span class="p">:</span>
    <span class="n">passw</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">password</span>
    <span class="n">set_keyring</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">instance</span><span class="p">,</span> <span class="n">options</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">passw</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">passw</span> <span class="o">=</span> <span class="n">check_keyring</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">instance</span><span class="p">,</span> <span class="n">options</span><span class="o">.</span><span class="n">user</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">passw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No Password specified and none found in keyring&#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">pysnc</span><span class="o">.</span><span class="n">ServiceNowClient</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">instance</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">PySNC</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation of PySNC</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">Advanced</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Authentication</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#basic-authentication">Basic Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="#oauth2-password-grant-flow">OAuth2 - Password Grant Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#oauth2-auth-code-grant-flow">OAuth2 - Auth Code Grant Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#oauth2-client-credential-grant-flow">OAuth2 - Client Credential Grant Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#oauth2-jwt-bearer-grant-flow">OAuth2 - JWT Bearer Grant Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mtls-mutual-tls-authentication-certificate-based-authentication">mTLS - Mutual TLS Authentication (Certificate-Based Authentication)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#requests-authentication">Requests Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="#storing-passwords">Storing Passwords</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">The API</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="advanced.html" title="previous chapter">Advanced</a></li>
      <li>Next: <a href="../api.html" title="next chapter">The API</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Matthew Gill.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/user/authentication.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>